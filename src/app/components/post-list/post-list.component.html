<div class="p-6 max-w-4xl mx-auto">
    @if (authenticationService.connectedUser | async ; as user) {

      <div class="mb-6">
        <h1 class="text-2xl font-bold text-gray-800 mb-2">Bonjour {{ connectedUser?.name||'utilisateur'}} 👋</h1>

        @if (groups.length > 0) {
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-semibold text-blue-700">
                Les posts du groupe : {{ groups[0].name }}
            </h2>
            <a routerLink="/post"
                class="bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 transition">
                ➕ Créer un post
            </a>
        </div>


        <ul class="space-y-4">
            @for (post of posts; track post.id) {
            <li class="bg-white p-4 rounded-lg shadow border">
                <p [innerHTML]="post.content" class="text-gray-800 mb-3 whitespace-pre-line"></p>
                <!-- @if (post.photoUrl) {
                <img [src]="post.photoUrl" alt="Photo du post" class="w-full max-w-xs rounded-lg object-cover" />
                }

                @if (post.videoUrl) {
                <video controls class="w-full max-w-md rounded-lg mt-3">
                    <source [src]="post.videoUrl" type="video/mp4" />
                    Votre navigateur ne supporte pas la lecture vidéo.
                </video>
                } -->
            </li>
            }
        </ul>
        }
        @else {
          <div class="mt-4">
            <p class="text-red-600 mb-4">
              Vous n'avez pas encore de groupe.
            </p>

            <form [formGroup]="groupFormGroup" (ngSubmit)="createGroup()" class="flex items-center gap-4">
              <input
                type="text"
                formControlName="name"
                required
                placeholder="Nom du groupe"
                class="border border-gray-300 px-3 py-2 rounded-md w-full max-w-xs"
              />
              <button
                type="submit"
                [disabled]="groupFormGroup.invalid"
                class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition">
                Créer
              </button>
            </form>
            <p class="mt-2 text-sm text-gray-600">
              ou
              <a routerLink="/groups/join" class="text-blue-500 underline">rejoignez-en un</a>.
            </p>
          </div>
        }
    </div>
    }
    @else {
    <div class="text-center mt-10">
        <h1 class="text-3xl font-bold text-gray-800 mb-4">Bienvenue sur <span class="text-blue-600">La Tribu</span>
            👨‍👩‍👧‍👦</h1>
        <p class="text-gray-600 text-lg">
            Connectez-vous pour voir les posts de votre groupe.
        </p>
    </div>
    }
</div>
